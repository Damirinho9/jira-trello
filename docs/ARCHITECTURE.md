# Mini Kanban Architecture and Plan

## TL;DR
- Стартуем с супер-простого варианта: одна HTML-страница, чистый JS/TypeScript не нужен, хранение в `localStorage`. Быстрое добавление, без бэкенда.
- Закладываем структуру данных под будущее API/DB: `Task`, `Board`, `Column`, `Comment`.
- ЭРК-подход: короткие блоки по ~45–50 минут, каждый даёт видимый артефакт.
- Первые шаги: рабочая доска + сохранение, потом фильтры, потом лёгкий бэкенд/синк (по желанию).

## Варианты стеков

### 1) Без бэкенда (SPA + браузерное хранилище)
- **Стек:** HTML + JS + (опционально) React/Vite, хранение в `localStorage`/`IndexedDB`.
- **Плюсы:** минимум трения, нет серверных затрат, офлайн работает, быстрый старт.
- **Минусы:** нет синхронизации между устройствами, сложнее делать многопользовательский доступ.
- **Когда брать:** личное пользование, быстрые итерации, офлайн важен. Рекомендован как старт.

### 2) Простой бэкенд
- **Стек:** Node + Express/Nest, SQLite (в файле) или PostgreSQL + Prisma/Drizzle.
- **Плюсы:** готовность к синку между устройствами, чёткая API-граница, проще расширять на мобильные/интеграции.
- **Минусы:** больше DevOps (деплой/бэкапы), больше кода и тестов.
- **Когда брать:** если через 2–3 недели точно понадобится веб/мобила синк или коллаборация.

### 3) Гибрид
- **Стек:** фронт как в (1), но хранение через маленький сервис (Cloudflare D1/Supabase). 
- **Плюсы:** синк почти "из коробки", меньше кода на бэке.
- **Минусы:** завязка на облако, нужен интернет.

**Рекомендация:** начать с варианта (1) — статичная страница + `localStorage`. Оставляем интерфейс данных так, чтобы позже заменить storage на API (адаптер). Это даёт минимальное трение сейчас и путь к расширяемости.

## Архитектура MVP

### Модель данных
```ts
// минимальный тип для MVP
export type Task = {
  id: string;
  title: string;
  description: string;
  status: TaskStatus; // inbox | plan | in_progress | done
  priority: 'low' | 'medium' | 'high';
  project: string; // тег/проект
  tags: string[];
  dueDate?: string; // ISO-датa, опционально
  comments: Comment[];
  createdAt: string;
  updatedAt: string;
};

export type Comment = {
  id: string;
  taskId: string;
  text: string;
  createdAt: string;
};
```

### Сущности и связи
- **Board** — набор колонок (статусы). У каждой колонки список `Task.id`.
- **Task** — принадлежит статусу, может иметь проект/теги, лог комментариев.
- **Comment** — принадлежит `Task`.
- **StorageAdapter** — интерфейс для чтения/записи (сейчас: `localStorage`; позже: API).

### Экраны/страницы
- **Главная/единственная страница**: 
  - Быстрый ввод задачи (только название, остальное опционально). 
  - Колонки: Inbox, План, В работе, Готово. 
  - Карточки с базовыми полями, кнопкой смены статуса.
  - Простые фильтры: по проекту и статусу (итерация 2).
  - Панель логов/комментов (итерация 3+).

## План по ЭРК (итерации ~45–50 мин)
1) **Итерация 1 — Рабочая доска + сохранение в localStorage.**
   - Верстка колонок.
   - Форма быстрого добавления (только название + опционально проект/приоритет/дедлайн/теги).
   - Переключение статуса карточки кнопками.
   - Сохранение/загрузка из `localStorage`.
2) **Итерация 2 — Фильтры и поиск.**
   - Фильтр по статусу, проекту; быстрый поиск по названию.
   - Визуальная подсветка активных фильтров.
3) **Итерация 3 — Комментарии и лог.**
   - Просмотр и добавление комментариев к задаче.
   - Хранение комментариев в `localStorage` вместе с задачей.
4) **Итерация 4 — Экспорт/импорт.**
   - Кнопка экспортировать JSON, импортировать (merge/replace).
5) **Итерация 5 — Лёгкий бэкенд (опционально).**
   - Небольшое API на Express + SQLite/Prisma.
   - Смена storage-адаптера, фронт без изменений.

## Файловая структура (старт)
```
/ (корень)
├─ index.html           # одно окно приложения
├─ src/
│  ├─ main.js           # логика UI и стейт
│  └─ styles.css        # простые стили
└─ docs/ARCHITECTURE.md # этот документ
```
При переходе к React/Vite структура может стать `/src/components`, `/src/hooks`, `/src/services/storage`.

## MVP первого релиза
- Открываем `index.html` — видим 4 колонки с задачами.
- Добавляем задачу через форму "Быстро добавить".
- Задачи живут между перезагрузками (localStorage).
- Можно менять статус кнопками в карточке.
- Экспортируем/импортируем JSON (merge/replace) через блок "Экспорт / импорт".

## Команды
- Без сборки: открыть `index.html` напрямую или запустить любой статический сервер, например `python -m http.server` из корня.
- Для будущего React/Vite: `npm create vite@latest`, перенести код в `src` компоненты.

## Заметки по расширяемости
- Хранение изолировано в `StorageAdapter` (см. `main.js`), можно позже заменить API вызовами.
- Используем `id` = timestamp + random для простоты; можно сменить на UUID.
- Комментарии и фильтры добавляются без ломки модели.
